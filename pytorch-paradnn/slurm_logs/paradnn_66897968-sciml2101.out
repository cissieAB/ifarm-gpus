+ source /etc/profile.d/modules.sh
++++ /bin/ps -p 48455 -ocomm=
+++ /bin/basename slurm_script
++ shell=slurm_script
++ '[' -f /usr/share/Modules/init/slurm_script ']'
++ . /usr/share/Modules/init/sh
+++ MODULESHOME=/usr/share/Modules
+++ export MODULESHOME
+++ '[' '' = '' ']'
+++ LOADEDMODULES=
+++ export LOADEDMODULES
+++ '[' /usr/share/Modules/modulefiles:/etc/modulefiles = '' ']'
+ module use /apps/modulefiles
++ /usr/bin/modulecmd sh use /apps/modulefiles
+ eval MODULEPATH=/apps/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles ';export' 'MODULEPATH;'
++ MODULEPATH=/apps/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles
++ export MODULEPATH
+ module load python3
++ /usr/bin/modulecmd sh load python3
+ eval LD_LIBRARY_PATH=/apps/python3/3.9.7/lib ';export' 'LD_LIBRARY_PATH;LOADEDMODULES=python3/3.9.7' ';export' 'LOADEDMODULES;PATH=/apps/python3/3.9.7/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin' ';export' 'PATH;_LMFILES_=/apps/modulefiles/python3/3.9.7' ';export' '_LMFILES_;'
++ LD_LIBRARY_PATH=/apps/python3/3.9.7/lib
++ export LD_LIBRARY_PATH
++ LOADEDMODULES=python3/3.9.7
++ export LOADEDMODULES
++ PATH=/apps/python3/3.9.7/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin
++ export PATH
++ _LMFILES_=/apps/modulefiles/python3/3.9.7
++ export _LMFILES_
+ pip3 install pandas numpy sklearn torch matplotlib
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pandas in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (1.5.0)
Requirement already satisfied: numpy in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (1.23.3)
Requirement already satisfied: sklearn in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (0.0)
Requirement already satisfied: torch in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (1.12.1)
Requirement already satisfied: matplotlib in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (3.6.0)
Requirement already satisfied: python-dateutil>=2.8.1 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from pandas) (2022.4)
Requirement already satisfied: scikit-learn in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from sklearn) (1.1.2)
Requirement already satisfied: typing-extensions in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from torch) (4.3.0)
Requirement already satisfied: pillow>=6.2.0 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (9.2.0)
Requirement already satisfied: contourpy>=1.0.1 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (1.0.5)
Requirement already satisfied: fonttools>=4.22.0 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (4.37.4)
Requirement already satisfied: packaging>=20.0 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (21.3)
Requirement already satisfied: kiwisolver>=1.0.1 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (1.4.4)
Requirement already satisfied: cycler>=0.10 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (0.11.0)
Requirement already satisfied: pyparsing>=2.2.1 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from matplotlib) (3.0.9)
Requirement already satisfied: six>=1.5 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from python-dateutil>=2.8.1->pandas) (1.16.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from scikit-learn->sklearn) (3.1.0)
Requirement already satisfied: scipy>=1.3.2 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from scikit-learn->sklearn) (1.9.1)
Requirement already satisfied: joblib>=1.0.0 in /w/epsci-sciwork18/xmei/jhub/lib/python3.9/site-packages (from scikit-learn->sklearn) (1.2.0)
WARNING: You are using pip version 21.2.3; however, version 22.3 is available.
You should consider upgrading via the '/apps/python3/3.9.7/bin/python3.9 -m pip install --upgrade pip' command.
++ hostname -s
+ hostname_str=sciml2101
+ platform=sciml2101-gpu
+ data_type=f16
+ outpath=./output/fc_66897968
+ mkdir -p ./output/fc_66897968
+ use_gpu=1
+ srun python3 fc.py --use_gpu=1 --input_type=f16
Torch version 1.12.1+cu102

Hyper-parameter configuration: 
  input_size: 1000
  output_size: 100
  layers: 8
  nodes: 1024
  batch_size: 1024
  device: Tesla T4
  input_tensor_type: f16
  #params: 8466432


Duration: 0.40399909019470215 seconds, TFLOPS: 12.875711720769152


+ for layers in 8
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_64_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=64 --use_gpu=1 --input_type=f16
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_128_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=128 --use_gpu=1 --input_type=f16
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_256_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=256 --use_gpu=1 --input_type=f16
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_512_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=512 --use_gpu=1 --input_type=f16
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_1024_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=1024 --use_gpu=1 --input_type=f16
+ for nodes in 64 128 256 512 1024 2048
+ name=benchmark_l_8_n_2048_f16_sciml2101-gpu
+ srun python3 fc.py -b --layers=8 --nodes=2048 --use_gpu=1 --input_type=f16
